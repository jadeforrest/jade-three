---
import SpotifyEmbed from './SpotifyEmbed.astro';
import PlatformLinks from './PlatformLinks.astro';
import type { Release } from '../types/releases';

interface Props {
  release: Release;
}

const { release } = Astro.props;

const typeLabel = release.type === 'ep' ? 'EP' : 'Album';
const releaseDate = new Date(release.releaseDate + 'T12:00:00');
const formattedDate = releaseDate.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---
<article class="bg-surface rounded-2xl overflow-hidden border border-white/5">
  <!-- Header -->
  <div class="px-6 pt-6 pb-4 flex items-start justify-between gap-4">
    <div>
      <h3 class="font-display text-2xl font-semibold text-text-primary leading-tight">
        {release.title}
      </h3>
      <p class="text-sm text-text-muted mt-1">
        {typeLabel} &middot; {formattedDate}
      </p>
    </div>
    <PlatformLinks
      spotifyUrl={release.spotifyUrl}
      appleMusicUrl={release.appleMusicUrl}
      amazonMusicUrl={release.amazonMusicUrl}
      youtubeUrl={release.youtubeUrl ?? release.youtubePlaylistUrl}
      size={18}
      class="pt-1 shrink-0"
    />
  </div>

  <!-- Embed -->
  <div class="px-6 pb-6">
    <SpotifyEmbed spotifyId={release.spotifyId} type="album" />
  </div>
</article>
