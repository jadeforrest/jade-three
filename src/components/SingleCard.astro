---
import SpotifyEmbed from './SpotifyEmbed.astro';
import PlatformLinks from './PlatformLinks.astro';
import type { Release } from '../types/releases';

interface Props {
  release: Release;
}

const { release } = Astro.props;
const embedId = release.tracks[0]?.spotifyId ?? release.spotifyId;
const releaseDate = new Date(release.releaseDate + 'T12:00:00');
const formattedDate = releaseDate.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---
<article class="bg-surface rounded-2xl overflow-hidden border border-white/5 flex flex-col hover:-translate-y-0.5 transition-transform duration-200">
  <!-- Info -->
  <div class="px-4 pt-4 pb-2">
    <h3 class="font-display text-base font-semibold text-text-primary leading-snug line-clamp-2">
      {release.title}
    </h3>
    <p class="text-xs text-text-muted mt-0.5">{formattedDate}</p>
  </div>

  <!-- Spotify embed -->
  <div class="px-4 flex-1">
    <SpotifyEmbed spotifyId={embedId} type="track" height={152} />
  </div>

  <!-- Platform links -->
  <div class="px-4 py-3">
    <PlatformLinks
      spotifyUrl={release.spotifyUrl}
      appleMusicUrl={release.appleMusicUrl}
      amazonMusicUrl={release.amazonMusicUrl}
      youtubeUrl={release.youtubeUrl}
      size={16}
    />
  </div>
</article>
